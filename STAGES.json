{
    "project_goal": "A web-first (Next.js + FastAPI) railway tampering system accepting real photo/video evidence via Clerk-authenticated mobile uploads, processed by a TWO-STAGE YOLOv8 pipeline, and displayed on a laptop dashboard.",
    "stages": [
        {
            "id": "1_scaffolding",
            "title": "Repo Scaffolding & Cleanup",
            "status": "completed",
            "tasks": [
                "Delete legacy MQTT files",
                "Create new folder structure: backend/, frontend/, uploads/, frames/, reports/",
                "Update requirements.txt for FastAPI stack"
            ]
        },
        {
            "id": "2_backend_core",
            "title": "FastAPI Backend & Uploads",
            "status": "completed",
            "tasks": [
                "Create backend/database.py: SQLite schema for Media and Incident",
                "Create backend/main.py: FastAPI app with POST /api/v1/media/upload",
                "Implement frame extraction using ffmpeg"
            ]
        },
        {
            "id": "3_ml_pipeline",
            "title": "Two-Stage YOLOv8 Inference Pipeline",
            "status": "completed",
            "tasks": [
                "Train Binary Model (v4i dataset): defective/non-defective",
                "Train Detailed Model (v1i dataset): 9 defect classes",
                "Copy weights to models/binary_model.pt and models/detailed_model.pt",
                "Test cascade inference: Working correctly!",
                "Create backend/ml_worker.py: Integrate cascade into FastAPI"
            ]
        },
        {
            "id": "4_frontend_upload",
            "title": "Next.js Frontend: Uploads",
            "status": "in_progress",
            "tasks": [
                "Initialize Next.js app in frontend/",
                "Setup Clerk authentication (ClerkProvider)",
                "Create /upload page: File input (camera capture), geolocation, progress bar",
                "Connect to FastAPI backend"
            ]
        },
        {
            "id": "5_dashboard",
            "title": "Operator Dashboard",
            "status": "pending",
            "tasks": [
                "Create /dashboard page: Poll /api/v1/incidents",
                "Implement Leaflet/MapLibre integration for incident markers",
                "Add Incident Preview popup: Show key frame and Tampering Score",
                "PDF download functionality"
            ]
        },
        {
            "id": "6_demo_prep",
            "title": "Demo & Ngrok Setup",
            "status": "pending",
            "tasks": [
                "Configure ngrok for public access",
                "Verify mobile flow: Phone Upload -> Backend Process -> Laptop Dashboard Update",
                "Create local run script for one-command startup"
            ]
        }
    ],
    "current_focus": "Stage 4: Build the Next.js frontend with mobile upload capability",
    "remaining_work": [
        "1. Create backend/ml_worker.py - integrate cascade inference into upload flow",
        "2. Initialize Next.js app with Clerk auth",
        "3. Build /upload page (mobile camera capture)",
        "4. Build /dashboard page (incident map)",
        "5. Setup ngrok for demo"
    ],
    "cleanup_needed": [
        "Delete server/ folder (legacy MQTT code)",
        "Delete config/ folder if not needed"
    ]
}